val a = Array(12, 6, 15, 2, 20, 9)
 a.reduceLeft(_ + _)

https://blog.csdn.net/yu0_zhang0/article/details/81776459
http://lxw1234.com/archives/2018/01/890.htm
关系建模又叫ER建模，是数据仓库之父Inmon推崇的，其从全企业的高度设计一个3NF模型的方法，用实体加关系描述的数据模型描述企业业务架构，在范式理论上符合3NF，其是站在企业角度进行面向主题的抽象，而不是针对某个具体业务流程的，它更多是面向数据的整合和一致性治理，正如Inmon所希望达到的“single version of the truth”
Inmon的ER建模优点体现在规范性较好，冗余小，数据集成和数据一致性方面得到重视，适用于较为大型的企业级、战略级的规划，但缺点是需要全面了解企业业务、数据和关系，对于建模人员要求很高，实施周期非常长，

维度模型则是数据仓库领域另一位大师Ralph Kimball 所倡导的。维度建模以分析决策的需求为出发点构建模型，一般有较好的大规模复杂查询的响应性能，更直接面向业务，典型的代表是我们比较熟知的星形模型，以及在一些特殊场景下适用的雪花模型
模相对能快速上手，快速交付，但缺点是冗余会较多，灵活性比较差，但其实现在看来也没什么，淘宝在大数据之路书中也提到“淘宝数据平台变迁的过程正好解释了二者的不同，最初，淘宝业务单一、系统简单，主要是简单的报表系统；后期数据量越来越大，系统越来越多，尝试用ER建模的数据仓库，但是在实践中发现快速变化的业务之下，构建ER模型的风险和难度都很高，现在则主要采用基于维度建模的模型方法了。”

优点：多维数据模型最大的优点就是其基于分析优化的数据组织和存储模式
缺点：多维模型的缺点就是与关系模型相比其灵活性不够，一旦模型构建就很难进行更改。


1. 对于涉及多表连接以及聚合计算的查询请求，关系模型不如维度模型查询效率高
2. 维度模型更适合作为分析型应用（OLAP、BI）的基础——易用，易理解，查询效率高
3. 关系模型更适于频繁update、insert的应用（事务型应用）
4. 在实时数据流上，普遍认为3NF比维度模型更具实时性处理的优势，因为前者更贴近OLTP数据源，涉及到的转换、聚合相对更少些（可见“参考4”链接）
5. 个人感觉，关系模型更面向“技术”层面，要满足3NF对表进行范式化，属于物理模型；而维度模型，其物理底层实际上还是表和关系，但从概念上有了进一步抽象，面向“业务”层面，尤其符合DW的主题特性。
在数据仓库领域对这二者模型的讨论，往往又牵涉到构建数据集市的方式，这就涉及Kimball vs Inmon的所谓“圣战”了。这方面没有定论，也不可能有定论。不管黑猫白猫，捉到老鼠就是好猫；不管关系还是维度，高效解决问题的就是好模型。参考4的连接中有人把这两种模型比作Ford和Chevy，也有比作高速公路和城市公路的，其实大可不必争论好坏，特有特色而已。另外，我不知道有多少把DW当做数据平台，上层再架其他数据平台，以DW为数据源来满足更上层需要的，添加一层尽管减少了耦合，让DW更为通用，但同时带来了更大的复杂度：DW->上层数据平台需要新的ETL过程；上层数据平台又要花费更多的开发代价；多了一层，实时的难度加大

select RQ,
sum(case RS when '胜'  then 1 else 0 end )as '胜',
sum(case RS  when '负'  then 1 else 0 end  ) as '负'
from  Game GROUP BY RQ HAVING RQ<'2016-05-11';

SELECT game.RT,Team.TN,
sum(if(RS= '胜',1,0))as '胜',
sum(if(RS= '负',1,0 ))as '负'
from game,team
WHERE game.RT=team.RT GROUP BY game.RT order by game.RT;

2016-05-09,A,胜
2016-05-09,C,胜
2016-05-09,B,负
2016-05-09,E,负
2016-05-10,A,胜
2016-05-10,E,负
2016-05-10,C,负
2016-05-10,B,负
2016-05-11,A,胜
2016-05-11,B,负
2016-05-11,D,胜
2016-05-11,C,负

A,北京国安
B,广州恒大
C,上海申花
D,山东鲁能
E,大连一方

create table if not exists grade(
stno,bigInt,
gender, String,
classNo,int,
gra, float,
testtime,date
)row format delimited fields terminated by ','

select stno,sum(gra) as gra from grade where gender='m' group by stno having gra <60 order by stno ;
